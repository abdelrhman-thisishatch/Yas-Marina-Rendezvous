# ููุฎุต ุฏุนู OAuth2 ูุน Microsoft 365

## โ ูุง ุชู ุฅูุฌุงุฒู

ุชู ุชุญุฏูุซ ุงูุชุทุจูู ูุฏุนู **OAuth2** ูุน Microsoft 365 ุงุณุชุฌุงุจุฉ ูุทูุจ ุงูุนููู ูุฅููุงู Microsoft ูุฏุนู App Password.

### ุงููููุงุช ุงููุญุฏุซุฉ:

1. **config.php** - ุชูุช ุฅุถุงูุฉ ุฅุนุฏุงุฏุงุช OAuth2:
   - `USE_OAUTH2` - ุชูุนูู/ุฅูุบุงุก OAuth2
   - `OAUTH_CLIENT_ID` - ูุนุฑู ุงูุชุทุจูู ูู Azure
   - `OAUTH_CLIENT_SECRET` - ุณุฑ ุงูุชุทุจูู ูู Azure
   - `OAUTH_TENANT_ID` - ูุนุฑู ุงููุณุชุฃุฌุฑ (ุงุฎุชูุงุฑู)
   - `OAUTH_REFRESH_TOKEN` - ุฑูุฒ ุงูุชุญุฏูุซ
   - `OAUTH_USER_EMAIL` - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู

2. **send-email-smtp.php** - ุชูุช ุฅุถุงูุฉ:
   - ุฏุนู ูุงูู ูู OAuth2 ูุน Microsoft 365
   - ุงูุชุญูู ุงูุชููุงุฆู ูู ุงูููุชุจุงุช ุงููุทููุจุฉ
   - ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ
   - ุฏุนู ููุทุฑููุชูู: OAuth2 (ููุตู ุจู) ู Password (ูุฏูู)

### ุงููููุงุช ุงูุฌุฏูุฏุฉ:

1. **composer.json** - ููู ุงูุชุจุนูุงุช:
   - `league/oauth2-client` - ููุชุจุฉ OAuth2

2. **OAUTH2-SETUP-GUIDE.md** - ุฏููู ุดุงูู ุจุงูุนุฑุจูุฉ:
   - ุฎุทูุงุช ุงูุชุณุฌูู ูู Azure
   - ููููุฉ ุงูุญุตูู ุนูู ุงูุฑููุฒ
   - ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

3. **oauth-setup.php** - ุฃุฏุงุฉ ูุณุงุนุฏุฉ:
   - ููุญุตูู ุนูู Refresh Token ุจุณูููุฉ
   - ูุงุฌูุฉ ููุจ ุจุณูุทุฉ

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ ููุนููู

### 1. ุชุซุจูุช ุงูููุชุจุงุช
```bash
composer install
```

### 2. ุชุณุฌูู ุงูุชุทุจูู ูู Azure AD
- ุงุชุจุน ุงูุฏููู ูู `OAUTH2-SETUP-GUIDE.md`
- ุงุญุตู ุนูู Client ID ู Client Secret
- ุฃุถู ุงูุฃุฐููุงุช: `SMTP.Send` ู `offline_access`

### 3. ุงูุญุตูู ุนูู Refresh Token
- ุงุณุชุฎุฏู `oauth-setup.php` ููุญุตูู ุนูู Refresh Token
- ุฃู ุงุชุจุน ุงูุทุฑู ุงูุจุฏููุฉ ูู ุงูุฏููู

### 4. ุชุญุฏูุซ config.php
```php
define('USE_OAUTH2', true);
define('OAUTH_CLIENT_ID', '...');
define('OAUTH_CLIENT_SECRET', '...');
define('OAUTH_REFRESH_TOKEN', '...');
```

### 5. ุงูุงุฎุชุจุงุฑ
- ุฌุฑุจ ุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู
- ุชุญูู ูู `email_log.txt`

## ๐ ุงูุฃูุงู

- **ุงุญุฐู `oauth-setup.php`** ุจุนุฏ ุงูุญุตูู ุนูู Refresh Token
- **ูุง ุชุฑูุน `config.php`** ุฅูู Git
- **ุงุณุชุฎุฏู HTTPS** ุฏุงุฆูุงู
- **ุงุญูุธ ุงูุฑููุฒ** ูู ููุงู ุขูู

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุชุทุจูู ูุฏุนู ุงูุขู ุทุฑููุชูู**:
   - OAuth2 (ููุตู ุจู - Microsoft ููุตู ุจู)
   - Password (ูุฏูู - ูุฏ ูุชููู ุนู ุงูุนูู ูุฑูุจุงู)

2. **ุงูุชุญููู ุชุฏุฑูุฌู**:
   - ููููู ุงูุงุณุชูุฑุงุฑ ูู ุงุณุชุฎุฏุงู Password ุงูุขู
   - ุนูุฏ ุฌุงูุฒูุฉ OAuth2ุ ุบููุฑ `USE_OAUTH2` ุฅูู `true`

3. **ุงูุชูุงูู ูุน ุงูุฅุตุฏุงุฑุงุช ุงูุณุงุจูุฉ**:
   - ุฅุฐุง ูู ุชูุนูู OAuth2ุ ุณูุณุชุฎุฏู Password ูุงููุนุชุงุฏ
   - ูุง ุญุงุฌุฉ ูุชุบููุฑุงุช ููุฑูุฉ

## โ ุฅุฌุงุจุฉ ุนูู ุณุคุงู ุงูุนููู

**ุงูุณุคุงู**: ูู ุงูุชุทุจูู ูุฏุนู OAuth2ุ

**ุงูุฌูุงุจ**: โ **ูุนูุ ุงูุขู ูุฏุนู OAuth2 ุจุงููุงูู!**

- ุชู ุชุญุฏูุซ ุงูููุฏ ูุฏุนู OAuth2 ูุน Microsoft 365
- ูููู ููุนููู ุงุณุชุฎุฏุงู OAuth2 ุจุฏูุงู ูู App Password
- ุงูุชุทุจูู ูุชูุงูู ูุน ุชูุตูุงุช Microsoft ุงูุญุฏูุซุฉ

## ๐ ุงููุฑุงุฌุน

- [Microsoft OAuth2 Documentation](https://learn.microsoft.com/en-us/exchange/client-developer/legacy-protocols/how-to-authenticate-an-imap-pop-smtp-application-by-using-oauth)
- ุฏููู ุงูุฅุนุฏุงุฏ ุงููุงูู: `OAUTH2-SETUP-GUIDE.md`

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ**: ุชู ุฅุถุงูุฉ ุฏุนู OAuth2 ุงุณุชุฌุงุจุฉ ูุฅููุงู Microsoft ูุฏุนู App Password.

